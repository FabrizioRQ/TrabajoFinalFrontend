<header class="header">
  <div class="header-container">
    <div class="brand">
      <svg viewBox="0 0 24 24" width="32" height="32" stroke="#2D7FF9" fill="none" stroke-width="2" aria-hidden="true">
        <circle cx="12" cy="12" r="10"/>
        <path d="M9 10h.01M15 10h.01M8 14c1.2 1 2.4 1.5 4 1.5s2.8-.5 4-1.5"/>
      </svg>
      <h1>Monstruos Amigos</h1>
    </div>
  </div>
</header>

<main class="main">
  <h2>Lista de Psicólogos</h2>

  <section class="card">
    <h3>Filtrar Búsqueda</h3>
    <div class="form">
      <div class="form-group">
        <label for="tipoBusqueda">Tipo de búsqueda:</label>
        <select id="tipoBusqueda" [(ngModel)]="tipoBusqueda" name="tipoBusqueda" class="form-control">
          <option value="todos">Todos los psicólogos</option>
          <option value="id">Por ID</option>
          <option value="especialidad">Por especialidad</option>
          <option value="colegiatura">Por número de colegiatura</option>
          <option value="nombre-especialidad">Por nombre y especialidad</option>
        </select>
      </div>

      <div class="form-group" *ngIf="tipoBusqueda === 'id'">
        <label for="idBusqueda">ID del psicólogo:</label>
        <input
          id="idBusqueda"
          type="number"
          [(ngModel)]="idBusqueda"
          name="idBusqueda"
          placeholder="Ej: 1, 2, 3..."
          class="form-control">
      </div>

      <!-- Filtro por especialidad -->
      <div class="form-group" *ngIf="tipoBusqueda === 'especialidad'">
        <label for="especialidadBusqueda">Especialidad:</label>
        <input
          id="especialidadBusqueda"
          type="text"
          [(ngModel)]="especialidadBusqueda"
          name="especialidadBusqueda"
          placeholder="Ej: Psicología infantil, Terapia familiar..."
          class="form-control">
      </div>

      <!-- Filtro por colegiatura -->
      <div class="form-group" *ngIf="tipoBusqueda === 'colegiatura'">
        <label for="colegiaturaBusqueda">Número de colegiatura:</label>
        <input
          id="colegiaturaBusqueda"
          type="text"
          [(ngModel)]="colegiaturaBusqueda"
          name="colegiaturaBusqueda"
          placeholder="Ej: CP-12345"
          class="form-control">
      </div>

      <!-- Filtro por nombre y especialidad -->
      <div class="form-group" *ngIf="tipoBusqueda === 'nombre-especialidad'">
        <label for="nombreBusqueda">Nombre:</label>
        <input
          id="nombreBusqueda"
          type="text"
          [(ngModel)]="nombreBusqueda"
          name="nombreBusqueda"
          placeholder="Ej: Juan, María..."
          class="form-control">
      </div>

      <div class="form-group" *ngIf="tipoBusqueda === 'nombre-especialidad'">
        <label for="especialidadFiltroBusqueda">Especialidad:</label>
        <input
          id="especialidadFiltroBusqueda"
          type="text"
          [(ngModel)]="especialidadFiltroBusqueda"
          name="especialidadFiltroBusqueda"
          placeholder="Ej: Psicología clínica..."
          class="form-control">
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-primary" (click)="buscar()" [disabled]="cargando">
          {{ cargando ? 'Buscando...' : 'Buscar' }}
        </button>
        <button type="button" class="btn btn-secondary" (click)="limpiarFiltros()" [disabled]="cargando">
          Limpiar
        </button>
      </div>
    </div>
  </section>

  <!-- Mensaje de error -->
  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>

  <!-- Resultados -->
  <section class="card">
    <h3>Resultados ({{ psicologos.length }})</h3>

    <!-- Estado de carga -->
    <div *ngIf="cargando" class="loading">
      Cargando psicólogos...
    </div>

    <!-- Tabla de resultados -->
    <div class="table-wrap" *ngIf="!cargando && psicologos.length > 0; else sinResultados">
      <table class="table">
        <thead>
        <tr>
          <th>ID</th>
          <th>Especialidad</th>
          <th>N° Colegiatura</th>
          <th>ID Usuario</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let psico of psicologos">
          <td>{{ psico.id || 'N/A' }}</td>
          <td>{{ psico.especialidad }}</td>
          <td>{{ psico.numeroColegiatura }}</td>
          <td>{{ psico.idUsuario }}</td>
        </tr>
        </tbody>
      </table>
    </div>

    <ng-template #sinResultados>
      <p class="table-note" *ngIf="!cargando">
        {{ tipoBusqueda === 'todos' ? 'No hay psicólogos registrados.' : 'No se encontraron resultados para tu búsqueda.' }}
      </p>
    </ng-template>
  </section>
</main>
