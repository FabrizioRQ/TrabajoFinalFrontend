<!-- reset-password-component.html -->
<div class="container">
  <div class="logo">
    <img
      src="https://cdn-icons-png.flaticon.com/512/616/616408.png"
      alt="Monstruo"
    />
    <span>Monstruos Amigos</span>
  </div>

  <h2>Restablecer ContraseÃ±a</h2>

  <div *ngIf="!token" class="error-container">
    <p>El enlace de recuperaciÃ³n no es vÃ¡lido o ha expirado.</p>
    <button routerLink="/recuperacion" class="btn-primary">
      Solicitar nuevo enlace
    </button>
  </div>

  <form *ngIf="token" [formGroup]="resetForm" (ngSubmit)="enviarDatos()" class="reset-form">
    <div class="form-group">
      <label for="nuevaContraseÃ±a">Nueva ContraseÃ±a</label>
      <div class="password-input-container">
        <input
          [type]="getPasswordFieldType('nuevaContraseÃ±a')"
          id="nuevaContraseÃ±a"
          placeholder="Ingresa tu nueva contraseÃ±a"
          formControlName="nuevaContraseÃ±a"
          required
        />
        <button
          type="button"
          class="toggle-password"
          (click)="togglePasswordVisibility('nuevaContraseÃ±a')"
        >
          {{ passwordVisible['nuevaContraseÃ±a'] ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
        </button>
      </div>
      <small *ngIf="resetForm.get('nuevaContraseÃ±a')?.errors?.['pattern']" class="error-text">
        La contraseÃ±a debe tener al menos 8 caracteres, una mayÃºscula, una minÃºscula y un nÃºmero
      </small>
      <small *ngIf="resetForm.get('nuevaContraseÃ±a')?.errors?.['minlength']" class="error-text">
        MÃ­nimo 8 caracteres requeridos
      </small>
    </div>

    <div class="form-group">
      <label for="confirmarContraseÃ±a">Confirmar ContraseÃ±a</label>
      <div class="password-input-container">
        <input
          [type]="getPasswordFieldType('confirmarContraseÃ±a')"
          id="confirmarContraseÃ±a"
          placeholder="Confirma tu nueva contraseÃ±a"
          formControlName="confirmarContraseÃ±a"
          required
        />
        <button
          type="button"
          class="toggle-password"
          (click)="togglePasswordVisibility('confirmarContraseÃ±a')"
        >
          {{ passwordVisible['confirmarContraseÃ±a'] ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
        </button>
      </div>
      <small *ngIf="resetForm.get('confirmarContraseÃ±a')?.value && resetForm.get('nuevaContraseÃ±a')?.value && resetForm.get('confirmarContraseÃ±a')?.value !== resetForm.get('nuevaContraseÃ±a')?.value" class="error-text">
        Las contraseÃ±as no coinciden
      </small>
    </div>

    <button
      type="submit"
      [disabled]="resetForm.invalid || loading"
      class="submit-btn"
    >
      {{ loading ? 'Restableciendo...' : 'Restablecer ContraseÃ±a' }}
    </button>
  </form>

  <div *ngIf="mensaje" class="mensaje" [class.success]="tipoMensaje === 'success'" [class.error]="tipoMensaje === 'error'">
    {{ mensaje }}
  </div>
</div>
